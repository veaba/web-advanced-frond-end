(window.webpackJsonp=window.webpackJsonp||[]).push([[94],{441:function(t,s,a){"use strict";a.r(s);var e=a(42),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"vue"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue"}},[t._v("#")]),t._v(" Vue")]),t._v(" "),a("ul",[a("li",[a("RouterLink",{attrs:{to:"/vue/vue2-api/"}},[t._v("更多关于VUE API人工整理手记，见 /docs/vue-api.md @veaba")])],1)]),t._v(" "),a("div",{staticClass:"language-vue extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vue"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("@click")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("send"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n{{message}}\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" app "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  el"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#app"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*可以是class？*/")]),t._v("\n  data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    message"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello world!"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  methods"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"change something ha?"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"疑问点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#疑问点"}},[t._v("#")]),t._v(" 疑问点")]),t._v(" "),a("ul",[a("li",[t._v("vue 里面的打补丁 扮演何种角色？")]),t._v(" "),a("li",[t._v("vue如何处理定时器或者销毁定时器的？")])]),t._v(" "),a("blockquote",[a("p",[t._v("在"),a("code",[t._v("beforeDestroy")]),t._v("里面处理")])]),t._v(" "),a("div",{staticClass:"language-ecmascript 6 extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("export default {\n\t\n  data(){\n    return {\n      second:5,\n      timer:null\n    }\n  },\n  mounted:function(){\n    this.timer=setInterval(()=>{\n      if(this.second===0) this.backPre();\n      else this.second--\n    },1000)\n  },\n  beforeDestroy(){\n    clearInterval(this.timer)\n  },\n  methods:{\n    backPre(){\n      return 'Do you want what me to do,ha?'\n    }\n  }\n}\n\n")])])]),a("h2",{attrs:{id:"vue-基础知识"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue-基础知识"}},[t._v("#")]),t._v(" vue 基础知识")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("英文")]),t._v(" "),a("th",[t._v("建议翻译")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("observe/observer")]),t._v(" "),a("td",[t._v("侦听/侦听器")])]),t._v(" "),a("tr",[a("td",[t._v("watch/watcher")]),t._v(" "),a("td",[t._v("侦听/侦听器")])]),t._v(" "),a("tr",[a("td",[t._v("subs")]),t._v(" "),a("td",[t._v("订阅")])]),t._v(" "),a("tr",[a("td",[t._v("patch")]),t._v(" "),a("td",[t._v("打补丁？")])]),t._v(" "),a("tr",[a("td",[t._v("deps")]),t._v(" "),a("td",[t._v("依赖关系")])])])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Vue 响应式原理分析")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("核心 Object.defineProperty 在一个对象上定义一个新属性，修改一个对象的现有属性，并返回这个对象。"),a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty",target:"_blank",rel:"noopener noreferrer"}},[t._v("mdn了解defineProperty"),a("OutboundLink")],1)]),t._v(" "),a("ul",[a("li",[t._v("语法")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n*@obj 要定义属性的对象\n*@prop 要定义或修改的属性的名称\n*@descriptor 定义或修改的属性描述符，一个对象。核心的是get/set\n* get 给属性提供一个getter方法，访问该属性则触发getter方法\n* set 给属性提供一个setter方法，当对属性修改时触发setter方法\n*/")]),t._v(" \nObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineProperty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("prop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("descriptor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  \n")])])]),a("ul",[a("li",[t._v("一旦对象拥有了getter和setter，可以认为这个对象是响应式对象")])])]),t._v(" "),a("li",[a("p",[t._v("vue 把什么对象变成响应式对象?")]),t._v(" "),a("ul",[a("li",[t._v("initState。初始化就是props、data变成响应式对象\n"),a("ul",[a("li",[t._v("_init 方法执行时候，会执行initState(vm)方法，定义在src/core/instance/state.js")]),t._v(" "),a("li",[t._v("initProps")]),t._v(" "),a("li",[t._v("initMethods")]),t._v(" "),a("li",[t._v("initData")]),t._v(" "),a("li",[t._v("initComputed")]),t._v(" "),a("li",[t._v("initWatch")])])])])]),t._v(" "),a("li",[a("p",[t._v("proxy 代理")]),t._v(" "),a("ul",[a("li",[t._v("作用时将props 和data上的属性都代理到vm实例上。")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" comP"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  props"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    msg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  methods"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("say")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n      *@desc  say函数通过this.msg访问到定义在props上的msg，这个过程就发生在proxy\n      */")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" sharePropertyfinition"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  enumerable"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  configurable"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  get"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("noop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  set"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("noop\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n *@desc proxy函数\n *@desc 通过Object.defineProperty 把target[sourceKey][key]读写变成target[key]\n */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("proxy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sourceKey"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  sharePropertyDefinition"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("proxyGetter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("sourceKey"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  sharePropertyDefinition"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("proxySetter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("val")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("sourceKey"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("val\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  Object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineProperty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sharePropertyDefinition"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])])]),t._v(" "),a("li",[a("p",[t._v("observe")]),t._v(" "),a("ul",[a("li",[t._v("监测数据的变化，定义在src/core/observer/index.js")]),t._v(" "),a("li",[t._v("给非vnode对象类型数据添加一个Observer，添加或已有返回，否则满足一定情况下，实例化一个？Observer对象实例")])])]),t._v(" "),a("li",[a("p",[t._v("getter: 依赖收集")]),t._v(" "),a("ul",[a("li",[t._v("const dep = new Dep() 实例化一个Deo的的实例")]),t._v(" "),a("li",[t._v("通过dep.depend 收集依赖")]),t._v(" "),a("li",[t._v("Dep 整个getter依赖收集的核心")]),t._v(" "),a("li",[t._v("依赖收集的目的是当这些响应式数据发送变化时，触发他们的setter的时候，能够知道通知哪些订阅者去做响应的逻辑处理，这过程叫派发更新。")])])]),t._v(" "),a("li",[a("p",[t._v("setter: 派发更新。收集的目的是为了修改数据时候，对相关的依赖派发更新")]),t._v(" "),a("ul",[a("li",[t._v("如果shallow 为false 对新设置的值变化成一个响应式对象")]),t._v(" "),a("li",[t._v("dep.notify()通知所有订阅者。\n"),a("ul",[a("li",[t._v("遍历所有订阅者subs，也就是watcher的实例数组，然后调用watcher的update方法")]),t._v(" "),a("li",[t._v("queueWatcher  放在nextTick队列，等待flushSchedulerQueue\n"),a("ul",[a("li",[t._v("flushSchedulerQueue 队列排序。\n"),a("ul",[a("li",[t._v("先父到子")]),t._v(" "),a("li",[t._v("用户watcher 优先render watcher")]),t._v(" "),a("li",[t._v("执行期间被销毁则跳过")])])]),t._v(" "),a("li",[t._v("flushSchedulerQueue 队列遍历\n"),a("ul",[a("li",[t._v("watcher.run()每次都是queue.length求值。\n"),a("ul",[a("li",[t._v("this.getAndInvoke方法，并传入watcher的回调函数。")])])])])]),t._v(" "),a("li",[t._v("状态恢复。\n"),a("ul",[a("li",[t._v("resetSchedulerState  函数。\n"),a("ul",[a("li",[t._v("变量恢复到初始值，清空watcher队列")])])])])])])])])])])]),t._v(" "),a("li",[a("p",[t._v("Dep")]),t._v(" "),a("ul",[a("li",[t._v("一个依赖就是一个watcher")]),t._v(" "),a("li",[t._v("是一个class，有一个target静态属性，全局唯一Watcher,被认为是一个巧妙的设计，保证同一时间只有一个全局的watcher被计算。另外自身属性subs 也是watcher的数组。\n"),a("ul",[a("li",[t._v("Dep 是watcher的一种管理，脱离watcher单独存在没有意义")]),t._v(" "),a("li",[t._v("触发getter时候，会调用dep.depend()方法，也会执行Dep.target.addDep(this)")]),t._v(" "),a("li",[t._v("Dep.target已经被赋值为渲染watcher，会执行addDep方法，保证同一数据不会被添加多次。执行dep.addSub(this)，执行this.subs.push(sub)。把watcher订阅到这个数据持有的dep的subs中，为后续数据变化时候能通知到哪些subs做准备")]),t._v(" "),a("li",[t._v("完成依赖收集之后，再递归访问value，触发所有子项的getter—— popTarget()")]),t._v(" "),a("li",[t._v("Dep.target=targetStack.pop() 返回成上一个状态，因为当前vm的数据依赖收集已完成。对应的Dep.target也需要改变，最后执行this.cleanUpDeps()")]),t._v(" "),a("li",[t._v("this.cleanUpDeps()\n"),a("ul",[a("li",[t._v("变量deps，移除对dep的订阅。交换newDepIds 和depIds，newDeps和deps，并把newDepIds和newDeps清空")])])])])])])]),t._v(" "),a("li",[a("p",[t._v("defineReactive 方法")]),t._v(" "),a("ul",[a("li",[t._v("定义一个响应式对象，给对象添加getter/setter，src/core/observer/index中")]),t._v(" "),a("li",[t._v("初始化Dep对象实例")]),t._v(" "),a("li",[t._v("对子对象递归调用observe方法，保证无论访问多少层的属性都能触发getter/setter")]),t._v(" "),a("li",[t._v("最后利用Object.defineProperty方法对obj属性的key 添加getter/setter")])])]),t._v(" "),a("li",[a("p",[t._v("Observer 通过Object.defineProperty实现对属性变化的监听。")]),t._v(" "),a("ul",[a("li",[t._v("是一个类")]),t._v(" "),a("li",[t._v("作用是，给对象的属性添加一个getter、setter，用于依赖收集和派发更新")]),t._v(" "),a("li",[t._v("构造函数逻辑：实例化Dep对象")]),t._v(" "),a("li",[t._v("为对象添加一个__ob__属性，调用def(封装的Object.defineProperty)")]),t._v(" "),a("li",[t._v("对value判断\n"),a("ul",[a("li",[t._v("是数。调用observeArray 方法——先遍历数组再调用observe方法")]),t._v(" "),a("li",[t._v("是纯对象。调用walk方法——先\n遍历对象，再调用defineReactive方法")])])])])]),t._v(" "),a("li",[a("p",[t._v("Watcher 订阅者。observe和compile之间，负责将变化的数据更新到视图")]),t._v(" "),a("ul",[a("li",[t._v("是一个class 。")]),t._v(" "),a("li",[t._v("this.deps Watcher实例持有Dep实例的数组")]),t._v(" "),a("li",[t._v("this.newDeps Watcher实例持有Dep实例的数组")]),t._v(" "),a("li",[t._v("this.desIds —— this.deps id Set结构")]),t._v(" "),a("li",[t._v("this.newDepIds —— this.newDeps id Set结构")]),t._v(" "),a("li",[t._v("至于为什么有两个实例数组？")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("deps "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("newDeps "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("depIds "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("newDepIds "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])])]),t._v(" "),a("li",[a("p",[t._v("生命周期，选项？？？这个在Vue构造器的传参中何种方式？")]),t._v(" "),a("ul",[a("li",[t._v("beforeCreate 实例初始化后 data observer 和event/watcher 事件配置之前被调用")]),t._v(" "),a("li",[t._v("created 实例创建完成被立即调用（data observe，属性和方法的运损，watch/event事件回调），此时"),a("code",[t._v("挂载")]),t._v("还没有开始,"),a("code",[t._v("$el")]),t._v("目前不可见。当然此时也是可以通过nextTick()来取到document的")]),t._v(" "),a("li",[t._v("beforeMount 挂载之前被调用，render函数首次被调用，该钩子在服务端渲染器件不被调用")]),t._v(" "),a("li",[t._v("mounted "),a("code",[t._v("el")]),t._v("被新创建的"),a("code",[t._v("vm.$el")]),t._v("替换，并挂载到实例上调用，无法确保所有子组件都一起挂载。ssr不被调用。希望等到整个视图都渲染完毕，可以：")])]),t._v(" "),a("div",{staticClass:"language-ecmascript 6 extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("  export default {\n   mounted(){\n        this.$nextTick=function(){\n          //拉拉\n        }\n      }\n}\n")])])]),a("ul",[a("li",[t._v("beforeUpdate 数据更新时，发生在爱DOM"),a("code",[t._v("打补丁")]),t._v("之前，适合更新之前访问现有的DOM，如手动移除已添加的事件监听器。SSR渲染期间不可用")]),t._v(" "),a("li",[t._v("updated 数据更新导致虚拟DOM重新渲染和"),a("code",[t._v("打补丁")]),t._v("，DOM已更新，无法确保所有子组件全都一起被重绘。SSR渲染器件不可用。可以这样做：")])]),t._v(" "),a("div",{staticClass:"language-ecmascript 6 extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("export default {\n  updated(){\n        this.$nextTick=function(){  \n      \t  // do something\n  \t\t}\n      }\n    }\n")])])]),a("ul",[a("li",[t._v("activated keep-alive 组件激活时被调用，SSR渲染期间不可用")]),t._v(" "),a("li",[t._v("deactivated keep-alive 组件停用时调用，SSR渲染期间不可用")]),t._v(" "),a("li",[t._v("beforeDestroy 实例销毁之前调用，在这一步实例依然完全可以用，SSR渲染期间不可用")]),t._v(" "),a("li",[t._v("destroyed 实例销毁后被调用，调用后实例指示所有东西解绑，所有事件移除，子实例也被销毁，SSR渲染期间不可用")]),t._v(" "),a("li",[t._v("errorCaptured 当捕获一个来自子孙组件的错误时被调用，(errorObj、发生错误组件实例、一个错误来源信息的字符串)，可以返回false阻止该错误向上传播")])])]),t._v(" "),a("li",[a("p",[t._v("组件通信")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("父传子")]),t._v(" "),a("ul",[a("li",[t._v("$props")])])]),t._v(" "),a("li",[a("p",[t._v("子传父")]),t._v(" "),a("ul",[a("li",[t._v("$emit")])])])])]),t._v(" "),a("li",[a("p",[t._v("api")])])]),t._v(" "),a("h2",{attrs:{id:"api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#api"}},[t._v("#")]),t._v(" api")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("el\n可以是css 选择器，可以是HTMLElement 实例"),a("sub",[a("a",{attrs:{href:"http://www.w3school.com.cn/xmldom/dom_htmlelement.asp",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTMLElement实例是什么?"),a("OutboundLink")],1)])])]),t._v(" "),a("li",[a("p",[t._v("全局")])])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" Vue"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//config、全局配置")]),t._v("\n  config"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      silent"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//boolean 取消vue所有的日志的警告")]),t._v("\n      optionMergeStrategies"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("_test")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//{[key:string]:Function}//自定义合并策略的选项")]),t._v("\n      devtools"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//生产false,允许vue-devtools检查代码")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("errorHandle")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("info")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//默认undefined，")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("warnHandler")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("trace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//警告处理函数，开发环境下生效")]),t._v("\n      ignoredElements"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Array<string|RegExp> 忽略vue之外定义的元素")]),t._v("\n      keyCodes"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//{ [key: string]: number | Array<number> }")]),t._v("\n      performance"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true浏览器开发者工具性能跟踪")]),t._v("\n      productionTip"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//false 阻止vue启动时生成生产提示")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//extend")]),t._v("\n  extend"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//使用vue构造器创建一个子类，拓展构造器！！！")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// nextTick")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("nextTick")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// set")]),t._v("\n  set"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//确保响应式更新")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("delete")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//避免被删除无法触发更新，但尽量少用它")]),t._v("\n  directive"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("definition"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//指令")]),t._v("\n  filter"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("defintion"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//注册或获取全局过滤器")]),t._v("\n  component"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("definition"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//注册或获取全局组件")]),t._v("\n  use"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("object"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Function"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//安装vue 插件")]),t._v("\n  mixin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("Object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//混入")]),t._v("\n  compile"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//template 编译字符")]),t._v("\n  version"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("string"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//版本号")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"vue-cli-3-0"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue-cli-3-0"}},[t._v("#")]),t._v(" vue-cli 3.0")]),t._v(" "),a("ul",[a("li",[t._v("则选择typescript+vue的开始模式")]),t._v(" "),a("li",[t._v("也支持预装")])]),t._v(" "),a("h3",{attrs:{id:"开发者注意以下问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开发者注意以下问题"}},[t._v("#")]),t._v(" 开发者注意以下问题")]),t._v(" "),a("ul",[a("li",[t._v("product 环境下，关闭sourceMap")]),t._v(" "),a("li",[t._v("product 环境下，尽量关闭console")]),t._v(" "),a("li",[t._v("配置devServer")]),t._v(" "),a("li",[t._v("多页应用,会导致页面重复大一倍")])]),t._v(" "),a("h2",{attrs:{id:"vue-router-路由"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue-router-路由"}},[t._v("#")]),t._v(" vue-router  路由")]),t._v(" "),a("ul",[a("li",[t._v("vue router 懒加载")]),t._v(" "),a("li",[t._v("vue 路由的几种模式，history 和hash 的原理是什么？")])]),t._v(" "),a("h2",{attrs:{id:"vue-相关面试题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue-相关面试题"}},[t._v("#")]),t._v(" vue 相关面试题")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("为什么vue 的data 是一个函数?")]),t._v(" "),a("ul",[a("li",[t._v("由于js语法特性决定来使用一个函数赋值。")])])])]),t._v(" "),a("h2",{attrs:{id:"基于vue-cli-3-0-demo项目框架"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基于vue-cli-3-0-demo项目框架"}},[t._v("#")]),t._v(" 基于vue-cli 3.0 demo项目框架")]),t._v(" "),a("h2",{attrs:{id:"vue源码学习"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue源码学习"}},[t._v("#")]),t._v(" vue源码学习")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"http://jiongks.name/blog/vue-code-review/",target:"_blank",rel:"noopener noreferrer"}},[t._v("勾三股四 Vue.js 源码学习笔记"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"http://hcysun.me/2017/03/03/Vue%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0/",target:"_blank",rel:"noopener noreferrer"}},[t._v("HcySunYang Vue2.1.7源码学习"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"http://hcysun.me/vue-design/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vue技术内幕-HcySunYang"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://ustbhuangyi.github.io/vue-analysis/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vue.js 技术揭秘-ustbhuangyi"),a("OutboundLink")],1)])]),t._v(" "),a("h3",{attrs:{id:"vue3-0-先占坑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue3-0-先占坑"}},[t._v("#")]),t._v(" vue3.0 "),a("code",[t._v("先占坑")])]),t._v(" "),a("blockquote",[a("p",[t._v("https://www.bilibili.com/video/av36787459/ vue-v2.5.16.js 3.0 最新进展，来自 Vue Conf 杭州")])]),t._v(" "),a("h4",{attrs:{id:"模板编译、virtual-dom-runtime性能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模板编译、virtual-dom-runtime性能"}},[t._v("#")]),t._v(" 模板编译、Virtual Dom runtime性能")]),t._v(" "),a("ul",[a("li",[t._v("Virtual DOM 实现 "),a("code",[t._v("完全重构，100%，减少运行时开销（潜在），编译时来提供性能")]),t._v(" "),a("ul",[a("li",[t._v("重构原生HTML标签的判断逻辑，编译时，判断标签，在运行时生成响应的标签或组件")]),t._v(" "),a("li",[t._v("生成虚拟Node，保持“形状一致”，同样个数的参数，利于JavaScript引擎优化")]),t._v(" "),a("li",[t._v("运行时留下Hint，静态分析元素包含的子元素类型，以便跳过不必要分支判断")])])]),t._v(" "),a("li",[t._v("优化Slots 生成\n"),a("ul",[a("li",[t._v("拆分父组件和子组件的耦合关系，引入生成函数，scope、slot统一称为一个函数，由子组件决定是否调用函数，并把传入的内容分配给子组件来完成收集，避免不要的组件渲染")]),t._v(" "),a("li",[t._v("真正依赖某个数据的组件，才会可能重新渲染，不存在手动优化组件过度重绘问题")])])]),t._v(" "),a("li",[t._v("静态内容提取\n"),a("ul",[a("li",[t._v("检测到一部分模板不会变，直接提取，在之后更新中，直接复用 Virtual dom，甚至可以在比对过程跳过整个树")]),t._v(" "),a("li",[t._v("包含深度动态内容时，如果元素所有的属性都是静态的，提取属性对象，比对元素时，发现data都一样，便可跳过，去比对children即可")])])]),t._v(" "),a("li",[t._v("内联事件函数提取\n"),a("code",[t._v('<Com @event="count++">')]),t._v(" "),a("ul",[a("li",[t._v("重新渲染时会生成新函数，Cache后，以便重用，避免子组件无谓更新的效果")])])])]),t._v(" "),a("h4",{attrs:{id:"数据监听系统"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据监听系统"}},[t._v("#")]),t._v(" 数据监听系统")]),t._v(" "),a("ul",[a("li",[t._v("把Object.defineProperty 改为 proxy")]),t._v(" "),a("li",[t._v("全语言特性支持\n"),a("ul",[a("li",[t._v("新属性增加")]),t._v(" "),a("li",[t._v("属性的删除")]),t._v(" "),a("li",[t._v("数组index")]),t._v(" "),a("li",[t._v("数组length 的修改")]),t._v(" "),a("li",[t._v("Map")]),t._v(" "),a("li",[t._v("Set")]),t._v(" "),a("li",[t._v("WeakMap")]),t._v(" "),a("li",[t._v("WeakSet")]),t._v(" "),a("li",[t._v("大规模数据帧听性能提升")])])]),t._v(" "),a("li",[t._v("利用proxy 内部判断，减少组件实例初始化开销")]),t._v(" "),a("li",[t._v("实测，内存减半，性能提升100%")])]),t._v(" "),a("h4",{attrs:{id:"减少runtime-体积-目测测试10kb左右"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#减少runtime-体积-目测测试10kb左右"}},[t._v("#")]),t._v(" 减少runtime 体积，目测测试10kb左右")]),t._v(" "),a("ul",[a("li",[t._v("tree-shaking代码结构，按需引入 import\n"),a("ul",[a("li",[t._v("内置组件\n"),a("ul",[a("li",[t._v("keep-alive")]),t._v(" "),a("li",[t._v("transition")])])]),t._v(" "),a("li",[t._v("指令运行时\n"),a("ul",[a("li",[t._v("v-model")]),t._v(" "),a("li",[t._v("v-for")])])]),t._v(" "),a("li",[t._v("工具函数\n"),a("ul",[a("li",[t._v("async component")]),t._v(" "),a("li",[t._v("mixins")]),t._v(" "),a("li",[t._v("memoize"),a("code",[t._v("new 新的工具函数")])])])])])])]),t._v(" "),a("h4",{attrs:{id:"更易维护"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更易维护"}},[t._v("#")]),t._v(" 更易维护")]),t._v(" "),a("ul",[a("li",[t._v("flow 迁移 typeScript\n"),a("ul",[a("li",[t._v("降低源码阅读能力，引入了类型信息")]),t._v(" "),a("li",[t._v("内部模块解耦，如独立observer")]),t._v(" "),a("li",[t._v("让更多的开发者参与进来")])])]),t._v(" "),a("li",[t._v("编译器重构\n"),a("ul",[a("li",[t._v("插件化设计")]),t._v(" "),a("li",[t._v("带位置信息的parser（source maps）")]),t._v(" "),a("li",[t._v("铺路 IDE工具链，如 vetur 作者作为vscode团队成员参与vue 3.0的开发")])])])]),t._v(" "),a("h4",{attrs:{id:"多端渲染支持"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#多端渲染支持"}},[t._v("#")]),t._v(" 多端渲染支持")]),t._v(" "),a("ul",[a("li",[t._v("场景\n"),a("ul",[a("li",[a("code",[t._v("vue native")])]),t._v(" "),a("li",[a("code",[t._v("wexx")])]),t._v(" "),a("li",[a("code",[t._v("mpvue")]),t._v(" 小程序")])])]),t._v(" "),a("li",[t._v("vue作为runtime编译到多端\n"),a("ul",[a("li",[t._v("独立出真正的 customer render API，在 "),a("code",[t._v("import {createRenderer} from '@vue/runtime-core'")]),t._v("，平台无关vue runtime")]),t._v(" "),a("li",[t._v("vue组件和 Virtual Dom 直接渲染到元素的对象上去")])])])]),t._v(" "),a("h4",{attrs:{id:"响应式数据监听api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#响应式数据监听api"}},[t._v("#")]),t._v(" 响应式数据监听API")]),t._v(" "),a("ul",[a("li",[t._v("实现跨组件的状态共享")]),t._v(" "),a("li",[t._v("排查组件更新的触发原因\n"),a("ul",[a("li",[t._v("提供新的 renderTriggered API")])])])]),t._v(" "),a("h4",{attrs:{id:"更好的typescript-支持以及原生的class-api-和-tsx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更好的typescript-支持以及原生的class-api-和-tsx"}},[t._v("#")]),t._v(" 更好的typeScript 支持以及原生的Class API 和 TSX")]),t._v(" "),a("ul",[a("li",[t._v("甚至不需要babel")])]),t._v(" "),a("h4",{attrs:{id:"更好的警告信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更好的警告信息"}},[t._v("#")]),t._v(" 更好的警告信息")]),t._v(" "),a("ul",[a("li",[t._v("组件堆栈包含函数式组件")]),t._v(" "),a("li",[t._v("可以在警告信息中查看组建的props")]),t._v(" "),a("li",[t._v("在更新的警告中提供组件堆栈信息")])]),t._v(" "),a("h4",{attrs:{id:"experimental-hooks-api-逻辑重用机制-可能取代mixins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#experimental-hooks-api-逻辑重用机制-可能取代mixins"}},[t._v("#")]),t._v(" Experimental Hooks API，逻辑重用机制，可能取代mixins")]),t._v(" "),a("ul",[a("li",[t._v("Hooks 替代mixins")]),t._v(" "),a("li",[t._v("Time Slicing Support 切割JavaScript 计算，一帧一帧去处理，预留每16ms yield给浏览器让用户事件重新进来，允许中间有机会让用户添加进事件")])]),t._v(" "),a("h4",{attrs:{id:"关于ie"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关于ie"}},[t._v("#")]),t._v(" 关于IE")]),t._v(" "),a("ul",[a("li",[t._v("IE11自动降级为旧的getter/setter机制")]),t._v(" "),a("li",[t._v("并引入增加不支持IE的语法警告")])]),t._v(" "),a("h3",{attrs:{id:"启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[t._v("#")]),t._v(" 启动")]),t._v(" "),a("div",{staticClass:"language-mpm extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("cnpm install -g karma (运行时test 是基于 Karma 的)\ncnpm install --save mime-db\ncnpm install (安装依赖)\ncnpm run dev:test\n\n")])])]),a("h3",{attrs:{id:"源码项目结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#源码项目结构"}},[t._v("#")]),t._v(" 源码项目结构")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/vuejs/vue/blob/dev/.github/CONTRIBUTING.md#development-setup",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue官方开发文档"),a("OutboundLink")],1)]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("scripts")]),t._v(" 一般不需要关注，不过熟悉以下两个文件会更好")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("scripts/alias.js")]),t._v("  所有源码和测试中使用模块导入的别名")]),t._v(" "),a("li",[a("code",[t._v("scripts/config.js")]),t._v(" 包含生成"),a("code",[t._v("dist/")]),t._v("的所有文件的配置，查找入口文件，都在这个"),a("code",[t._v("dist")]),t._v("都在里面")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("dist")]),t._v(" 包含用户发布的内置文件。此目录只会在发布的时候更新，并不能说明当前开发的最新特性变化。")]),t._v(" "),a("ul",[a("li",[t._v("关于dist的信息请查看 "),a("a",{attrs:{href:"https://github.com/vuejs/vue/blob/dev/dist/README.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("更多"),a("OutboundLink")],1)])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("flow")]),t._v(" 包含flow 的类型声明。全局加载的，可以在普通源码中看到他们在注释中的使用")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("packages")]),t._v(" 包含 vue ssr 和 vue 模板编译 包。vue的依赖包")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("test")]),t._v(" 包含所有测试。单元测试是Jasmine写的，运行是用Karma。e2e 是Nighwatch.js 编写和运行的。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("src")]),t._v(" 包含源代码。基本代码是es2015编写的，并用flow 来做类型注释")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("compiler")]),t._v(" 编译器。包含模板转函数编译器的代码。")]),t._v(" "),a("li",[a("code",[t._v("parse")]),t._v(" 解析器（将字符串模板转为抽象语法树AST）")]),t._v(" "),a("li",[a("code",[t._v("optimizer")]),t._v(" 优化器（检测用于"),a("code",[t._v("vdom")]),t._v("呈现优化的静态树）")]),t._v(" "),a("li",[a("code",[t._v("code generator")]),t._v("代码生成器（将抽象语法树生成渲染函数代码）")])]),t._v(" "),a("p",[t._v("代码生成器直接从抽象语法树生成字符串，这样做的代码规格较小，因为编译器在独立构建中，发送给浏览器的")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("core")]),t._v(" 包含通用，无关平台运行时的代码。\n"),a("ul",[a("li",[t._v("vue2.0开始 core 就与平台无关。这意味着，你可以运行在浏览器、nodejs、或者嵌入式js里面。")]),t._v(" "),a("li",[a("code",[t._v("observer")]),t._v(" 观察者。包含与响应式系统相关的代码。")]),t._v(" "),a("li",[a("code",[t._v("vdom")]),t._v(" 虚拟dom。 包含虚拟dom 创建元素的相关代码和补丁。")]),t._v(" "),a("li",[a("code",[t._v("instance")]),t._v(" 实例。包含Vue 实例构造函数和原型对象(prototype)方法。")]),t._v(" "),a("li",[a("code",[t._v("global-api")]),t._v(" 顾名思义，就是全局的api")]),t._v(" "),a("li",[a("code",[t._v("components")]),t._v(" 通过抽象组件，目前 keep-alive 是唯一的一个。")])])]),t._v(" "),a("li",[a("code",[t._v("server")]),t._v("　包含ssr（服务端渲染 server-side rendering）相关代码")]),t._v(" "),a("li",[a("code",[t._v("platforms")]),t._v(" 包含特定平台的代码。")])]),t._v(" "),a("p",[t._v("来自 "),a("code",[t._v("dist/build")]),t._v("的入口文件位于各自平台的目录中。\n每个平台模块包含三个部分：编译器compiler、运行时runtime、服务器server。对应上面的三个目录，每个部分都包含特定的平台的 模块/实用 程序，然后导出并注入到平台特定的目录文件中的core项中。例如，实现v-bind:class 背后的逻辑的核心就是在 "),a("code",[t._v("platforms/web/runtime/modules/class.js")]),t._v(" ——这个入口是在"),a("code",[t._v("entries/web-runtime.js")]),t._v(" ，用于创建特定浏览器的vdom的修补功能。")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("sfc")]),t._v(" 包含单文件组件(*.vue)解析逻辑。用到 package 中的 vue-template-compiler 依赖包。")]),t._v(" "),a("li",[t._v("包含整个代码库中共享的实用程序。")])])])])])}),[],!1,null,null,null);s.default=n.exports}}]);